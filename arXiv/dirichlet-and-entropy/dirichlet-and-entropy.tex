\documentclass[11pt,fleqn]{article}


% Necessities

\usepackage{amsmath,amssymb}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{xcolor}
\hypersetup{colorlinks,linkcolor={blue!50!black},citecolor={red!50!black},urlcolor={blue!70!black}}
\usepackage[nameinlink,noabbrev,capitalize]{cleveref}
\usepackage{tikz}
\usetikzlibrary{decorations.pathreplacing,decorations.pathmorphing}
\usepackage{tikz-cd}
\usepackage{mathtools}


% Style

\usepackage[margin=1.5in,top=1in,bottom=1.3in]{geometry}

\usepackage{fouriernc}
\usepackage[cal=esstix,scr=rsfs]{mathalfa}

\crefname{section}{\S\!}{\S\S\!}


% Theorem environments

\usepackage{amsthm,thmtools}

\declaretheorem[name=Theorem,numberwithin=section]{theorem}
\declaretheorem[name=Corollary,numberlike=theorem]{corollary}
\declaretheorem[name=Lemma,numberlike=theorem]{lemma}
\declaretheorem[name=Proposition,numberlike=theorem]{proposition}

\declaretheorem[name=Definition,style=definition,numberlike=theorem,qed={$\lrcorner$}]{definition}
\declaretheorem[name=Example,style=definition,numberlike=theorem,qed={$\lrcorner$}]{example}
\declaretheorem[name=Remark,style=definition,numberlike=theorem,qed={$\lrcorner$}]{remark}


% Shortcuts

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}

\newcommand{\yon}{\mathcal{y}}
\newcommand{\inv}{^{-1}}
\newcommand{\op}{^\textnormal{op}}
\newcommand{\id}{\textnormal{id}}

\newcommand{\cat}[1]{\mathtt{#1}}
\newcommand{\rig}[1]{\mathsf{#1}}
\newcommand{\Set}{\cat{Set}}
\newcommand{\FSet}{\cat{FSet}}
\newcommand{\Dir}{\rig{Dir}}
\newcommand{\cDir}{\cat{Dir}}
\newcommand{\Rect}{\rig{Rect}}

\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\prob}{\mathbb{P}}


% Information

\title{Dirichlet polynomials and entropy}
\author{David I. Spivak\footnote{\texttt{david@topos.institute}} \qquad Timothy Hosgood\footnote{\texttt{tim@topos.institute}}}

\usepackage[style=alphabetic,backend=bibtex,maxnames=99,maxalphanames=4]{biblatex}
\addbibresource{dirichlet-and-entropy.bib}


% DOCUMENT START

\begin{document}

\maketitle

\begin{abstract}
  A Dirichlet polynomial $d$ in one variable $\yon$ is a function of the form $d(\yon)=a_n n^\yon+\cdots+a_22^\yon+a_11^\yon+a_00^\yon$ for some $n,a_0,\ldots,a_n\in\mathbb{N}$.
  We will show how to think of a Dirichlet polynomial as a set-theoretic bundle, and thus as an empirical distribution.
  We can then consider the Shannon entropy $H(d)$ of the corresponding probability distribution, and we define its \emph{length} (or, classically, its \emph{perplexity}) by $L(d)=2^{H(d)}$.
  On the other hand, we will define a rig homomorphism $h\colon\Dir\to\Rect$ from the rig of Dirichlet polynomials to the so-called \emph{rectangle rig}, whose underlying set is $\mathbb{R}_{\geq0}\times\mathbb{R}_{\geq0}$ and whose additive structure involves the weighted geometric mean;
  we write $h(d)=(A(d),W(d))$, and call the two components \emph{area} and \emph{width} (respectively).

  The main result of this paper is the following: the rectangle-area formula $A(d)=L(d)W(d)$ holds for any Dirichlet polynomial $d$.
  In other words, the entropy of an empirical distribution can be calculated entirely in terms of the homomorphism $h$ applied to its corresponding Dirichlet polynomial.
  We also show that similar results hold for the cross entropy.
\end{abstract}


% Content

\section{Introduction}
\label{section:introduction}

The purpose of this note is simply to provide another categorical treatment of \emph{entropy} of probability distributions, which turns out to be computed in terms of a rig homomorphism;
our treatment also generalises to \emph{cross entropy} (and thus to \emph{Kullback--Leibler divergence}).
What is particularly interesting about the treatment outlined here is that we can somewhat ``visualise'' the notion of entropy in terms of sizes of coding schemes (cf. \cref{section:understanding-the-numbers}).
Not only that, but classical entropy is only homomorphic in the product of distributions, whereas the notion that we describe here is homomorphic in both the product and the sum.

A brief outline of this paper is as follows:
\begin{itemize}
  \item[\cref{section:dir-and-bun}:]
    We recall the definitions of \emph{Dirichlet polynomials}\footnote{One important thing to note is the following: Dirichlet polynomials are well studied objects in the setting of complex analysis, but we \emph{cannot} apply tools from this area to our setting, because we have only \emph{natural number} coefficients and \emph{non-negative} exponents.} and \emph{set-theoretic bundles}, along with their rig structures, from \cite{SM2020};
    we then study the equivalence between these two notions.
  \item[\cref{section:bun-and-emp}:]
    We explain how \emph{empirical probability distributions} correspond to set-theoretic bundles (and thus to Dirichlet polynomials).
  \item[\cref{section:area-and-width}:]
    We define the \emph{rig homomorphism} $h\colon\Dir\to\Rect$ that we wish to study, whose codomain is a rig encoding the weighted geometric mean;
    we prove some useful computational results and give some explicit examples.
  \item[\cref{section:length}:]
    We define the \emph{entropy} $H(d)$ of a Dirichlet polynomial using the classical notion of Shannon entropy;
    we give some explicit examples;
    we prove the main result of this paper (\cref{theorem:rectangle-area-formula}), relating entropy to the rig homomorphism defined in the previous section.
  \item[\cref{section:understanding-the-numbers}:]
    We try to provide some intuition for the image $h(d)$ of a Dirichlet polynomial under the rig homomorphism, in terms of \emph{coding schemes}.
  \item[\cref{section:cross-entropy}:]
    We generalise \cref{theorem:rectangle-area-formula} to the case of \emph{cross-entropy}, or \emph{Kullback--Leibler divergence}.
\end{itemize}

\begin{figure}[h!]
\centering
  \begin{tikzpicture}
    \draw[thick] (0,0) rectangle ++(4,2);
    \draw[thick,Latex-Latex] (0,-0.25) to node[label={below:{\emph{length}}}]{} (4,-0.25);
    \draw[thick,Latex-Latex] (-0.25,0) to node[label={left:{\emph{width}}}]{} (-0.25,2);
    % to centre the picture
    \draw[thick,Latex-Latex,white] (4.25,0) to node[label={right:{\emph{width}}}]{} (4.25,2);
  \end{tikzpicture}
  \caption{Our convention for naming the sides of a rectangle, from \cite{KS2020}.}
\end{figure}


\subsection*{Acknowledgements}

The first author acknowledges support from AFOSR grant no.~{FA9550-20-1-0348}.


\section{Dirichlet polynomials and bundles}
\label{section:dir-and-bun}

\emph{This section is simply a brief summary of content from \cite{SM2020}, repeated here for the convenience of the reader.}

\begin{definition}
  A \emph{Dirichlet polynomial} $d$ in one variable $\yon$ is a function of the form $d(\yon)=a_n n^\yon + \ldots + a_2 2^\yon + a_1 1^\yon + a_0 0^\yon$ for some $n,a_0,\ldots,a_n\in\mathbb{N}$.

  The set of Dirichlet polynomials is clearly closed under addition, and further under multiplication (using the distributive law along with the fact that $m^\yon\cdot n^\yon=(m\cdot n)^\yon$).
  In fact, it has the structure of a \emph{rig}: a ``ring without negatives'' (or, to be pedantic, a monoid object in commutative monoids).
  We denote this rig by $\Dir$, where the additive unit is $0$, and the multiplicative unit is $1^\yon$.
  
  Note that we can embed $\mathbb{N}$ as a sub-rig of $\Dir$, by $a\mapsto a\cdot1^\yon$;
  we often use this fact and simply write $a\in\Dir$.
\end{definition}

Following \cite{SM2020}, we can think of Dirichlet polynomials as functors $\FSet\op\to\FSet$, where $\FSet$ is the category of finite sets.
Indeed, given a natural number $n\in\mathbb{N}$, the \emph{exponential} $n^\yon$ can be thought of as the Yoneda embedding of the set with $n$ elements\footnote{For typographical convenience, we sometimes use the notation $n$ and $\underline{n}$ interchangeably. In particular, we write e.g. $d(0)$ instead of $d(\underline{0})$.}, i.e.
\[
  n^\yon = \FSet\,(-,\underline{n})
\]
where $\underline{n}=\{1,\ldots,n\}$.
Then addition of exponentials corresponds to the coproduct of the corresponding representable functors (and so multiplication by a natural number $a_n$ corresponds to the $a_n$-fold coproduct of the representable functor with itself).
This means that evaluating a Dirichlet polynomial at some natural number $n$ corresponds to evaluating the corresponding functor on the finite set $\underline{n}$.

Note that $0^\yon$ is \emph{not} the initial object $0$, since
\[
  0^{\underline{n}} =
  \begin{cases}
    1 &\mbox{if $n=0$;}
  \\0 &\mbox{if $n\geq1$}
  \end{cases}
\]
i.e. $0^\yon\neq0$.

\begin{example}
  The Dirichlet polynomial
  \[
    d(\yon) = 4^\yon + 4\cdot1^\yon
  \]
  evaluated at $0$ gives
  \[
    \begin{aligned}
      d(0)
      &= \FSet\,(\underline{0},\underline{4}) \sqcup \left( \sqcup_{i=1}^4 \FSet\,(\underline{0},\underline{1}) \right)
    \\&\cong \underline{1} \sqcup \underline{4}
    \\&\cong \underline{5},
    \end{aligned}
  \]
  and, similarly,
  \[
    \begin{aligned}
      d(1)
      &= \FSet\,(\underline{1},\underline{4}) \sqcup \left( \sqcup_{i=1}^4 \FSet\,(\underline{1},\underline{1}) \right)
    \\&\cong \underline{4} \sqcup \underline{4}
    \\&\cong \underline{8}.
    \end{aligned}
  \]
  Note that, since $1^\yon=1$, we can write $d(\yon)=4^\yon+4$.
\end{example}

\begin{definition}
  A \emph{morphism} $\varphi\colon d\to e$ of Dirichlet polynomials is a natural transformation of (contravariant) functors.
  Denote by $\cDir$ the category of Dirichlet polynomials (thought of as functors $\FSet\op\to\FSet$), and by $\cDir\,(d,e)$ the set of all morphisms $d\to e$.
\end{definition}

When we think of Dirichlet polynomials as functors $\FSet\op\to\FSet$, addition is given by the coproduct (disjoint union of sets), and multiplication by the product (cartesian product of sets).
This means that working with Dirichlet polynomials in $\cDir$ really is like working with polynomials, in the sense that addition and multiplication are exactly ``as expected''.

\begin{example}
  The only slightly confusing aspect of multiplication in $\Dir$ is how $0^\yon$ behaves (since $0^\yon\neq0$):
  if $d(\yon)$ is a Dirichlet polynomial, then
  \[
    d(\yon)\cdot0^\yon = d(0)\cdot0^\yon,
  \]
  as follows from the aforementioned fact that $0^{\underline{n}}$ is zero for $n\neq0$, and $1$ for $n=0$.

  We can use this general fact for specific computations.
  For example, let
  \[
    \begin{aligned}
      d(\yon)&\coloneqq 3\cdot2^\yon+1^\yon
    \\e(\yon)&\coloneqq 4^\yon+2^\yon+3\cdot0^\yon.
    \end{aligned}
  \]
  Then
  \[
    \begin{aligned}
      (d\cdot e)(\yon)
      &= (3\cdot8^\yon + 3\cdot4^\yon + 9\cdot0^\yon) + (4^\yon + 2^\yon + 3\cdot0^\yon)
    \\&= 3\cdot8^\yon + 4\cdot4^\yon + 2^\yon + 12\cdot0^\yon.
    \end{aligned}
  \]
  (and $d+e = 4^\yon + 4\cdot2^\yon + 1^\yon + 3\cdot0^\yon$).
\end{example}

There is a more geometric interpretation\footnote{This vague statement can be upgraded to an equivalence of categories (cf. \cref{lemma:morphism-of-dir-is-morphism-of-bund}, or \cite[Theorem~4.6]{SM2020} for more details).} of objects of $\Dir$ as \emph{set-theoretic bundles}, i.e. (isomorphism classes of) functions $E\to B$, where $E,B\in\FSet$, given as follows:
to the Dirichlet polynomial $d\colon\FSet\op\to\FSet$, we associate the function $\pi_d=d(!)\colon d(1)\to d(0)$ induced by the unique function $!\colon\underline{0}\to\underline{1}$.

For example, to the polynomial $d(\yon)=4^\yon+4\cdot1^\yon$, we associate the bundle
\[
  \begin{tikzpicture}[scale=0.5]
    \node at (-2,2.5) {$d(1)\cong\underline{8}\cong$};
    \begin{scope}
      \draw[rounded corners] (0,0) rectangle ++(6,5);
      \foreach \y in {1,2,3,4}
        \draw[thick,black,fill=gray] (1,\y) circle (2mm);
      \foreach \x in {2,3,4,5}
        \draw[thick,black,fill=gray] (\x,1) circle (2mm);
    \end{scope}
    \draw[thick,-Latex] (3,-0.5) to (3,-1.5);
    \node at (3.75,-1) {$\pi_d$};
    \node at (-2,-3) {$d(0)\cong\underline{5}\cong$};
    \begin{scope}[shift={(0,-4)}]
      \draw[rounded corners] (0,0) rectangle ++(6,2);
      \foreach \x in {1,2,3,4,5}
        \draw[thick,black,fill=white] (\x,1) circle (2mm);
    \end{scope}
  \end{tikzpicture}
\]

Note that bundles also form a rig, where the sum is given by disjoint union of sets, and the product is given by the cartesian product of sets, both on the base and the total space.
Further, the equivalence between Dirichlet polynomials and bundles respects the rig structures.\footnote{cf. \cite[Theorem~4.6]{SM2020}.}
Because of this, we often switch freely between thinking of Dirichlet polynomials as functors $d\colon\FSet\op\to\FSet$, as bundles $\pi_d\colon d(1)\to d(0)$, and simply as functions of the form $\sum_{j=0}^n a_n\cdot n^\yon$.

\begin{example}
  We can draw the bundle corresponding to $(2^\yon+1)\cdot(2^\yon+1)$ as follows:
  \[
    \begin{tikzpicture}[scale=0.5]
      \begin{scope}
        \begin{scope}
          \draw[rounded corners] (0,0) rectangle ++(3,3);
          \draw[thick,black,fill=gray] (1,1) circle (2mm);
          \draw[thick,black,fill=gray] (1,2) circle (2mm);
          \draw[thick,black,fill=gray] (2,1) circle (2mm);
        \end{scope}
        \draw[thick,-Latex] (1.5,-0.5) to (1.5,-1.5);
        \begin{scope}[shift={(0,-4)}]
          \draw[rounded corners] (0,0) rectangle ++(3,2);
          \draw[thick,black,fill=white] (1,1) circle (2mm);
          \draw[thick,black,fill=white] (2,1) circle (2mm);
        \end{scope}
        \node at (1.5,-5) {$2^\yon+1$};
      \end{scope}
      \node at (4.5,-1) {$\times$};
      \begin{scope}[shift={(6,0)}]
        \begin{scope}
          \draw[rounded corners] (0,0) rectangle ++(3,3);
          \draw[thick,black,fill=gray] (1,1) circle (2mm);
          \draw[thick,black,fill=gray] (1,2) circle (2mm);
          \draw[thick,black,fill=gray] (2,1) circle (2mm);
        \end{scope}
        \draw[thick,-Latex] (1.5,-0.5) to (1.5,-1.5);
        \begin{scope}[shift={(0,-4)}]
          \draw[rounded corners] (0,0) rectangle ++(3,2);
          \draw[thick,black,fill=white] (1,1) circle (2mm);
          \draw[thick,black,fill=white] (2,1) circle (2mm);
        \end{scope}
        \node at (1.5,-5) {$2^\yon+1$};
      \end{scope}
      \node at (10.5,-1) {$=$};
      \begin{scope}[shift={(12,0)}]
        \begin{scope}
          \draw[rounded corners] (0,0) rectangle ++(5,5);
          \foreach \y in {1,2,3,4}
            \draw[thick,black,fill=gray] (1,\y) circle (2mm);
          \foreach \y in {1,2}
            \draw[thick,black,fill=gray] (2,\y) circle (2mm);
          \foreach \y in {1,2}
            \draw[thick,black,fill=gray] (3,\y) circle (2mm);
          \draw[thick,black,fill=gray] (4,1) circle (2mm);
        \end{scope}
        \draw[thick,-Latex] (2.5,-0.5) to (2.5,-1.5);
        \begin{scope}[shift={(0,-4)}]
          \draw[rounded corners] (0,0) rectangle ++(5,2);
          \foreach \x in {1,2,3,4}
          \draw[thick,black,fill=white] (\x,1) circle (2mm);
        \end{scope}
        \node at (2.5,-5) {$4^\yon+2\cdot2^\yon+1$};
      \end{scope}
    \end{tikzpicture}
  \]
\end{example}

\begin{lemma}
\label{lemma:d0-and-d1-from-sum-form}
  Let $d(\yon)\coloneqq\sum_{j=0}^n a_n\cdot n^\yon$ be a Dirichlet polynomial.
  Then
  \[
    \begin{aligned}
      |d(0)| &= \sum\nolimits_{j=0}^n a_j
    \\|d(1)| &= \sum\nolimits_{j=0}^n a_j j.
    \end{aligned}
  \]
\end{lemma}

\begin{proof}
  This follows from the fact that $n^{\underline{0}}=1$ and $n^{\underline{1}}=n$, for all $n\in\mathbb{N}$.
\end{proof}

\begin{definition}
\label{definition:fibre-notation}
  Let $d\in\Dir$.
  For $i\in d(0)$, we define
  \[
    d[i] \coloneqq \pi_d^{-1}(i)
  \]
  where $\pi_d\colon d(1)\to d(0)$ is the bundle corresponding to $d$.
\end{definition}

Using the fact that the sum of bundles is given by the disjoint union of sets, we can use this above definition to write any Dirichlet polynomial $d$ as
\[
  d(\yon) \cong \sum_{i\in d(0)} d[i]^\yon
\]
(where $\sum$ is the coproduct in $\FSet$).

\begin{corollary}
\label{corollary:d0-and-d1-from-fibre-form}
  Let $d(\yon)\coloneqq\sum_{i\in d(0)} d[i]^\yon$ be a Dirichlet polynomial.
  Then
  \[
    |d(1)| = \sum\nolimits_{i\in d(0)} |d[i]|.
  \]
\end{corollary}

\begin{proof}
  This is, again, simply the fact that $n^{\underline{1}}=n$ for all $n\in\mathbb{N}$.
\end{proof}

\begin{lemma}
\label{lemma:morphism-of-dir-is-morphism-of-bund}
  A morphism $\varphi\colon d\to e$ of Dirichlet polynomials is exactly a morphism of the corresponding bundles, i.e. functions $\varphi_0\colon d(0)\to e(0)$ and $\varphi_1\colon d(1)\to e(1)$ such that
  \[
    \begin{tikzcd}
      d(1) \rar["\varphi_1"] \dar[swap,"\pi_d"]
      & e(1) \dar["\pi_e"]
    \\d(0) \rar[swap,"\varphi_0"]
      & e(0)
    \end{tikzcd}
  \]
  commutes.
\end{lemma}

\begin{proof}
  This statement forms a specific part of \cite[Theorem~4.6]{SM2020}, but the proof is simple enough that we give a direct version here.
  Writing $d(\yon)\coloneqq\sum_{i\in d(0)}d[i]^\yon$ and $e(\yon)\coloneqq\sum_{i\in e(0)}e[i]^\yon$, we see that
  \[
    \begin{aligned}
      \Hom_{[\FSet\op,\FSet]}(d,e)
      &\cong \prod_{i\in d(0)}\Hom_{[\FSet\op,\FSet]}\left(
        d[i]^\yon,
        \sum_{j\in e(0)}e[j]^\yon
      \right)
    \\&\cong \prod_{i\in d(0)}\sum_{j\in e(0)} e[j]^{d[i]}
    \\&= \prod_{i\in d(0)}\sum_{j\in e(0)} \Hom_{\FSet}(d[i],e[j])
    \end{aligned}
  \]
  (the first isomorphism is by the universal property of the coproduct;
  the second isomorphisms is the Yoneda lemma).
  But an element of this set is exactly a bundle morphism:
  we have, for all $i\in d(0)$, some $j\in e(0)$ along with a function $d[i]\to e[j]$;
  $\varphi_1$ is given by the disjoint union of all these $d[i]\to e[j]$, and $\varphi_0$ is given by the the choice of $j$ for each $i$.
\end{proof}

\begin{definition}
  Given Dirichlet polynomials $d,e\in\cDir$ such that $d(0)=e(0)$, we denote by $\cDir_{/d(0)}(d,e)$ the set of morphisms $(\varphi_0,\varphi_1)\colon d\to e$ such that $\varphi_0=\id$.
\end{definition}

Given the correspondence between Dirichlet polynomials and bundles, we might rightly ask why we should prefer to work with the former over the latter.
For one possible answer to this, see \cref{remark:why-dir-instead-of-bun}.



\section{Bundles as empirical distributions}
\label{section:bun-and-emp}

The interpretation of Dirichlet polynomials as bundles helps us to understand how they relate to probability theory.
Imagine flipping a coin eight times and observing five heads and three tails;
we refer to ``heads'' and ``tails'' as \emph{outcomes}, and each of the eight flips as \emph{draws};
every draw has an associated outcome.

Consider some bundle $\pi_d\colon d(1)\to d(0)$.
We can think of $d(0)$ as the set of outcomes, and $d(1)$ as the set of draws;
the fibre $\pi_d^{-1}(x)$ over an outcome $x\in d(0)$ corresponds to all the draws that lead to the outcome $x$, and so we obtain a probability distribution on $d(0)$ by setting $\prob(X=x)=\frac{|\pi_d^{-1}(x)|}{|d(0)|}$.
Conversely, any \emph{rational distribution} (i.e. a distribution such that all probabilities are rational numbers ) on a finite set arises in this way:
take the finite set as the set of outcomes;
take the least common multiple of the denominators of all the probabilities as the cardinality of $d(1)$;
and then take $\prob(X=x)\cdot |d(1)|$ many elements of $d(1)$ to be in the fibre of $x\in d(0)$.

\begin{example}
  Consider the set $S=\{x_1,x_2,x_3,x_4\}$, endowed with the probability distribution such that
  \[
    \begin{aligned}
      \prob(x_1) &= \frac{1}{5}
      \qquad\prob(x_2) = \frac{1}{6}
    \\\prob(x_3) &= \frac{1}{2}
      \qquad\prob(x_4) = \frac{2}{15}
    \end{aligned}
  \]

  Define the sets $d(0)=\underline{4}$ and $d(1)=\underline{30}$, and define the function $\pi_d\colon d(1)\to d(0)$ by
  \[
    \pi(n) =
    \begin{cases}
      1 &\mbox{if $0\leq n<6$;}
    \\2 &\mbox{if $6\leq n<11$;}
    \\3 &\mbox{if $11\leq n<26$;}
    \\4 &\mbox{if $26\leq n\leq30$.}
    \end{cases}
  \]
  Then the empirical probability distribution on the bundle $\pi\colon d(1)\to d(0)$ agrees exactly with the given distribution on $S$.
  As a Dirichlet polynomial, this bundle is given (up to relabelling the outcomes) by $d(\yon)\coloneqq15^\yon+6^\yon+5^\yon+4^\yon$.

  Note that any multiple $m^\yon\cdot d(\yon)$ of $d$ (for $m\geq1$) will correspond to the same probability distribution as $d$ itself, but to a different empirical distribution, since it will have $m$ times as many draws.
\end{example}

Under this interpretation of Dirichlet polynomials as empirical distributions, multiplication $d\cdot e$ corresponds to taking the \emph{product distribution}.

\begin{remark}
  For any $d\in\Dir$, and any $n\in\mathbb{N}$, we can give $|d(n)|$ a combinatorial interpretation: it is the number of ways of choosing $n$ indistinguishable (in the sense that they have the same outcome) draws, i.e. the number of length-$n$ lists of elements of $d[i]$ for some $i\in d(0)$.

  To see this, note that $d(n)=\cDir\,(n^\yon,d)$ (by Yoneda), and so $d(n)$ is in bijection with the set of bundle morphisms $(\varphi_0,\varphi_1)\colon(n\to1)\to(d(1)\to d(0))$, which are given exactly by choosing $n$ (possibly repeated) elements of $d(1)$ that all lie in the same fibre (namely the fibre above the point specified by $\varphi_0(1)$).
\end{remark}

\begin{remark}
  Although we deal only with \emph{finite} sets and \emph{rational} probability distributions here, it seems likely that one could follow the methods of \cite{FP2019} and consider colimits of these to obtain analogous results for \emph{arbitrary} probability distributions on \emph{discrete measurable spaces}.
\end{remark}



\section{Area and width}
\label{section:area-and-width}

\begin{definition}
\label{definition:rect}
  Define the rig $\Rect$ as follows.
  The underlying set is $\mathbb{R}_{\geq0}\times\mathbb{R}_{\geq0}$.
  The multiplicative structure has unit $(1,1)$, and is given by component-wise multiplication:
  \[
    (A_1,W_1)\cdot(A_2,W_2)\coloneqq(A_1A_2,W_1W_2).
  \]
  The additive structure has unit $(0,0)$, and is given by real-number addition in the first component, and by weighted geometric mean in the second component:
  \[
    (A_1,W_1) + (A_2,W_2)
    \coloneqq \left(
      A_1 + A_2,
      \big( W_1^{A_1} W_2^{A_2} \big)^{\frac{1}{A_1+A_2}}
    \right).
  \]
  Given an element $(A,W)$ in $\Rect$, we call $A$ its \emph{area} and $W$ its \emph{width}.
\end{definition}

The fact that $\Rect$ is indeed a rig follows from the fact that its multiplication distributes over its addition:
\[
  \begin{aligned}
    (A_1,W_1) \cdot \Big((A_2,W_2)+(A_3,W_3)\Big)
    &= (A_1,W_1) \cdot \left(
        A_2+A_3, \big(W_2^{A_2}W_3^{A_3}\big)^{\frac{1}{A_2+A_3}}
      \right)
  \\&= \left(
        A_1(A_2+A_3), W_1\big(W_2^{A_2}W_3^{A_3}\big)^{\frac{1}{A_2+A_3}}
      \right)
  \\&= \left(
        A_1A_2+A_1A_3, \big(W_1^{A_2+A_3}W_2^{A_2}W_3^{A_3}\big)^{\frac{1}{A_2+A_3}}
      \right)
  \\&= \left(
        A_1A_2+A_1A_3, \big((W_1W_2)^{A_2}(W_1W_3)^{A_3}\big)^{\frac{1}{A_2+A_3}}
      \right)
  \\&= \left(
        A_1A_2+A_1A_3, \big((W_1W_2)^{A_1A_2}(W_1W_3)^{A_1A_3}\big)^{\frac{1}{A_1A_2+A_1A_3}}
      \right)
  \\&= (A_1A_2,W_1W_2) + (A_1A_3,W_1W_3)
  \\&= (A_1,W_1)\cdot(A_2,W_2) + (A_1,W_1)\cdot(A_3,W_3).
  \end{aligned}
\]

\begin{proposition}
\label{proposition:unique-rig-morphism}
  There exists a unique rig morphism $h\colon\Dir\to\Rect$ for which
  \[
    h\colon n^\yon \mapsto (n,n).
  \]
\end{proposition}

\begin{proof}
  Since every Dirichlet polynomial is just a sum of exponentials, a rig homomorphism is fully determined by its action on exponentials, since it must respect addition.
  So we just need to show that $h$ does indeed extend to a rig homomorphism, but this follows from the fact that $m^\yon\cdot n^\yon=(m\cdot n)^\yon$.
\end{proof}

\begin{definition}
  Given a Dirichlet polynomial $d$, we define its \emph{area} $A(d)$ and its \emph{width} $W(d)$ to be given by the components of $h(d)=(A(d),W(d))$.
\end{definition}

With this definition, along with \cref{proposition:unique-rig-morphism}, we see that
\[
  A(n^\yon) = W(n^\yon) = n.
\]

\begin{lemma}
\label{lemma:h-and-scalar-multiples}
  Let $d\in\Dir$ and $a\in\mathbb{N}$.
  Then
  \begin{enumerate}[i.]
    \item $h(a)=(a,1)$;
    \item $A(a\cdot d)=aA(d)$;
    \item $W(a\cdot d)=W(d)$.
  \end{enumerate}
\end{lemma}

\begin{proof}
  Recall that addition (and thus scalar multiplication) in $\Rect$ involves the weighted geometric mean in the second component.
  Then
  \[
    \begin{aligned}
      h(a)
      \coloneqq& h(a\cdot1^\yon)
    \\=& a\cdot h(1^\yon)
    \\=& a\cdot(1,1)
    \\=& (a,1)
    \end{aligned}
  \]
  which proves (i).
  For (ii) and (iii), since $h$ is a rig homomorphism (and thus respects addition), it suffices to consider the case where $d$ is an exponential, say $d(\yon)=n^\yon$.
  But then
  \[
    \begin{aligned}
      h(a\cdot d)
      &= a\cdot h(d)
    \\&= a\cdot(n,n)
    \\&= \Big(
        an,
        \big(\underbrace{n^n n^n\ldots n^n}_{\mbox{\scriptsize$a$ times}}\big)^{1/an}
      \Big)
    \\&= \Big(
        an,
        \big(n^{an}\big)^{1/an}
      \Big)
    \\&= (an,n)
    \end{aligned}
  \]
  i.e. $A(a\cdot d)=aA(d)$ and $W(a\cdot d)=W(d)$, as claimed.
\end{proof}

\begin{corollary}
\label{corollary:area-and-width}
  Let $d\in\Dir$.
  Then
  \[
    \begin{aligned}
      A(d) &= |d(1)|
    \\W(d)^{A(d)} &= \left\vert\cDir_{/d(0)}(d,d)\right\vert.
    \end{aligned}
  \]
\end{corollary}

\begin{proof}
  Write $d(\yon)=a_n\cdot n^\yon+\ldots+a_1\cdot1^\yon+a_0\cdot0^\yon$.
  Using \cref{lemma:h-and-scalar-multiples}, along with \cref{definition:rect}, we see that
  \[
    \begin{aligned}
      h(d)
      &= (a_n n,n) + (a_{n-1}(n-1),n-1) + \ldots + (a_1,1)
    \\&= \left(
        \sum\nolimits_{i=0}^n a_i i,
        \left(\prod\nolimits_{i=0}^n i^{a_i i}\right)^{1/\sum_{i=0}^n a_i i}
      \right).
    \end{aligned}
  \]
  By \cref{lemma:d0-and-d1-from-sum-form}, the first component (i.e. $A(d)$) is equal to $|d(1)|$;
  by the same lemma, we can also rewrite the second component (i.e. $W(d)$) as
  \[
    W(d)
    = \left(\prod\nolimits_{i=0}^n i^{a_i i}\right)^{\frac{1}{A(d)}}
  \]
  so it simply remains to justify why this is equal to $\left\vert\cDir_{/d(0)}(d,d)\right\vert^{\frac{1}{A(d)}}$.
  But a morphism in $\cDir_{/d(0)}(d,d)$ is exactly the data of an endomorphism of each fibre of $\pi_d\colon d(1)\to d(0)$;
  since there are $a_i$ fibres of size~$i$, endomorphisms of these fibres are in bijection with the $a_i$-fold product of $i^i$, which is equal to $i^{a_i i}$, whence the claim.
\end{proof}

\begin{corollary}
\label{corollary:width-is-algebraic}
  Let $d\in\Dir$.
  Then the width $W(d)$ is an algebraic number, i.e. the image of $h\colon\Dir\to\Rect$ lies in the sub-rig whose underlying set is $\mathbb{N}\times\overline{\mathbb{Q}}_{\geq0}$, where $\overline{\mathbb{Q}}$ is the algebraic closure of $\mathbb{Q}$.
\end{corollary}

\begin{proof}
  By \cref{corollary:area-and-width}, both $W(d)^{A(d)}$ and $A(d)$ are equal to the cardinality of some sets, and thus integer.
\end{proof}

\begin{example}
\label{example:rectangles-are-rectangles}
  Reassuringly, if we start with a ``rectangle'', then the area and width are exactly what we might expect.
  More concretely:
  consider $d(\yon)=a\cdot n^\yon$ for some $a,n\in\mathbb{N}$;
  then, by \cref{corollary:area-and-width},
  \[
    A(d)
    = d(1)
    = an,
  \]
  and, by direct calculation,
  \[
    W(d)
    = n.
  \]
  Comparing this to the picture of $a\cdot n^\yon$, we can explain why we chose the terminology ``width'' and ``area'':
  \[
    \begin{tikzpicture}[scale=0.5]
      \node at (-2,-0.9) {$a\cdot n^\yon =$};
      \begin{scope}
        \draw[rounded corners] (0,0) rectangle ++(6,5);
        \foreach \x in {1,2,3,5} {
          \draw[thick,black,fill=gray] (\x,1) circle (2mm);
          \draw[thick,black,fill=gray] (\x,2) circle (2mm);
          \node at (\x,3.25) {$\vdots$};
          \draw[thick,black,fill=gray] (\x,4) circle (2mm);
        }
        \node at (4,1) {$\ldots$};
        \draw[thick,decorate,decoration={brace,raise=-0.35cm}] (7,4.5) to node {$n$} (7,0.5);
      \end{scope}
      \draw[thick,-Latex] (3,-0.5) to (3,-1.5);
      \begin{scope}[shift={(0,-4)}]
        \draw[rounded corners] (0,0) rectangle ++(6,2);
        \foreach \x in {1,2,3,5}
        \draw[thick,black,fill=white] (\x,1) circle (2mm);
        \node at (4,1) {$\ldots$};
        \draw[thick,decorate,decoration={brace,raise=-0.35cm}] (5.5,-1) to node {$a$} (0.5,-1);
      \end{scope}
    \end{tikzpicture}
  \]
  Indeed, the area is exactly the number of dots in the (upper) rectangle, and the width is its width.

  But this picture now leads us to consider the question of whether or not there is a good meaning we can give to the ``length'' of this rectangle (which, here, should be equal to $a$).
  Indeed, this has been our motivation all along; we will return to this question in \cref{example:rectangles-are-rectangles-cont}.
\end{example}

\begin{example}
\label{example:width-and-equal-distribution}
  The fact that $d(1)$ is ``rectangular'' in \cref{example:rectangles-are-rectangles} makes the terminology look like a numerical coincidence, but we can try to hone our intuition of what this really ``means'' by considering another example.

  Let's consider $d(\yon)=4^\yon+4$, which has area $A(d)=d(1)=8$.
  We can calculate its width by using the fact that
  \[
    \begin{aligned}
      h(4^\yon)
      &= (4,4)
    \\h(4)
      &= h(1^\yon) + h(1^\yon) + h(1^\yon) + h(1^\yon)
    \\&= (4,1)
    \end{aligned}
  \]
  whence
  \[
    \begin{aligned}
      h(d)
      &= (4,4) + (4,1)
    \\&= \left(8,(4^4 1^4)^{\frac{1}{8}}\right)
    \\&= (8,2)
    \end{aligned}
  \]
  and so $W(d) = 2$.

  \medskip

  How, then, does the rectangle with area $8$ and width $2$ relate to our Dirichlet polynomial $d(\yon)=4^\yon+4$?
  That is, what is the process that takes us from $d$ to $4\cdot2^\yon$?
  Looking at the pictures of the bundles, we see that the width tells us how our bundle would look if we had the same set ($d(1)$) of draws, but with different outcomes, now all \emph{equally likely}:
  \[
    \begin{tikzpicture}[scale=0.5]
      \begin{scope}
        \begin{scope}
          \draw[rounded corners] (0,0) rectangle ++(6,5);
          \foreach \y in {1,2,3,4}
            \draw[thick,black,fill=gray] (1,\y) circle (2mm);
          \foreach \x in {2,3,4,5}
            \draw[thick,black,fill=gray] (\x,1) circle (2mm);
        \end{scope}
        \draw[thick,-Latex] (3,-0.5) to (3,-1.5);
        \begin{scope}[shift={(0,-4)}]
          \draw[rounded corners] (0,0) rectangle ++(6,2);
          \foreach \x in {1,2,3,4,5}
            \draw[thick,black,fill=white] (\x,1) circle (2mm);
        \end{scope}
      \end{scope}
      \draw[->,thick,decorate,decoration={zigzag,amplitude=1.5,post length=5pt,post=lineto}] (6.5,2.5) to (9.5,1.75);
      \begin{scope}[shift={(10,0)}]
        \begin{scope}
          \draw[rounded corners] (0,0) rectangle ++(5,3);
          \foreach \x in {1,2,3,4}
            \foreach \y in {1,2}
              \draw[thick,black,fill=gray] (\x,\y) circle (2mm);
        \end{scope}
        \draw[thick,-Latex] (2.5,-0.5) to (2.5,-1.5);
        \begin{scope}[shift={(0,-4)}]
          \draw[rounded corners] (0,0) rectangle ++(5,2);
          \foreach \x in {1,2,3,4}
            \draw[thick,black,fill=white] (\x,1) circle (2mm);
        \end{scope}
      \end{scope}
    \end{tikzpicture}
  \]
  Note that, in order to have equally sized fibres, we needed to have $4$ outcomes, not $5$ (since $8/2=4$).
  We make this idea more precise (as well as explain why the rectangle is of size $4\times2$ instead of $2\times4$) in \cref{section:understanding-the-numbers}.
\end{example}

\begin{example}
\label{example:4-and-4-and-4-and-3}
  We have just seen that $d(\yon)=4^\yon+4$ has $W(d)=2$ and $A(d)=8$, but now let's look at an example where the numbers don't divide so neatly.
  
  Let $d(\yon)=4^\yon+3$.
  Then $A(d)=d(1)=7$, and, as in \cref{example:width-and-equal-distribution}, we use the fact that
  \[
    \begin{aligned}
      h(d)
      &= (4,4) + (3,1)
    \\&= \left(7,(4^4 1^3)^{\frac{1}{7}}\right)
    \\&= (7,2\sqrt[7]{2})
    \\&\approx (7,2.21)
    \end{aligned}
  \]
  Of course, now we can't draw a nice rectangle representing the evenly distributed bundle as we did in \cref{example:width-and-equal-distribution} for $4^\yon+4$, since we would have to have an outcome set of size $7/2.21\approx3.17$ elements, with fibres all of size $2.21$, but this should come as no surprise, since $7$ is prime.
  One might be tempted to solve this problem using groupoid cardinality (cf. \cite{BHW2009}), but there are some technical issues here.
\end{example}



\section{Length}
\label{section:length}

\emph{N.B. We write $\log$ to mean $\log_2$.}

\begin{definition}
  Given a Dirichlet polynomial $d(\yon)\coloneqq\sum_{i\in d(0)}d[i]^\yon$, we define its \emph{entropy} $H(d)$ by
  \[
    H(d) \coloneqq -\sum_{i\in d(0)} \frac{|d[i]|}{|d(1)|} \log\left(\frac{|d[i]|}{|d(1)|}\right).
  \]
  We then define its \emph{length} $L(d)$ by
  \[
    L(d)\coloneqq 2^{H(d)}.\qedhere
  \]
\end{definition}

Readers might recognise $H(d)$ as being the \emph{Shannon entropy} of the corresponding probability distribution (cf. \cite{S1948}).

\begin{example}
  Consider $d(\yon)=n^\yon$ for some $n\in\mathbb{N}$.

  \[
    \begin{tikzpicture}[scale=0.5]
      \begin{scope}
        \draw[rounded corners] (0,0) rectangle ++(2,5);
        \draw[thick,black,fill=gray] (1,1) circle (2mm);
        \draw[thick,black,fill=gray] (1,2) circle (2mm);
        \node at (1,3.25) {$\vdots$};
        \draw[thick,black,fill=gray] (1,4) circle (2mm);
        \draw[thick,decorate,decoration={brace,raise=-0.35cm}] (3,4.5) to node {$n$} (3,0.5);
      \end{scope}
      \draw[thick,-Latex] (1,-0.5) to (1,-1.5);
      \begin{scope}[shift={(0,-4)}]
        \draw[rounded corners] (0,0) rectangle ++(2,2);
        \draw[thick,black,fill=white] (1,1) circle (2mm);
      \end{scope}
    \end{tikzpicture}
  \]

  Then $d(0)=1$ and $d(1)=n$, and so
  \[
    \begin{aligned}
      H(d)
      &= -\sum_{i\in\underline{1}} \frac{n}{n} \log\left(\frac{n}{n}\right)
    \\&= -\log 1
    \\&= 0
    \end{aligned}
  \]
  whence $L(d) = 2^0 = 1$.

  In terms of distributions, this corresponds to the fact that the unique probability distribution on a single outcome has entropy equal to $0$ (and so the same is true for any empirical distribution on a single outcome).
\end{example}

\begin{example}
\label{example:rectangles-are-rectangles-cont}
  Continuing on from \cref{example:rectangles-are-rectangles}, we can calculate the entropy of a uniform distribution on $a$ many outcomes $d(\yon)=a\cdot n^\yon$ as
  \[
    \begin{aligned}
      H(a\cdot n^\yon)
      &= -\sum_{i\in\underline{a}} \frac{n}{an}\log\left(\frac{n}{an}\right)
    \\&= -\log\left(\frac{1}{a}\right)
    \\&= \log a
    \end{aligned}
  \]
  whence $L(a\cdot n^\yon) = 2^{\log a} = a$, exactly as desired.
\end{example}

\begin{example}
  Continuing on from \cref{example:4-and-4-and-4-and-3}, recall that $d(\yon)=4^\yon+4$ has area $A(d)=8$ and width $W(d)=2$.
  We can further calculate that
  \[
    \begin{aligned}
      H(d)
      &= -\sum_{i\in\underline{5}}\frac{|d[i]|}{8}\log\left(\frac{|d[i]|}{8}\right)
    \\&= -\frac{4}{8}\log\left(\frac{4}{8}\right) - 4\cdot\frac{1}{8}\log\left(\frac{1}{8}\right)
    \\&= -\frac{1}{2}\log\left(\frac{1}{16}\right)
    \\&= 2
    \end{aligned}
  \]
  whence $L(d) = 2^2 = 4$.

  \medskip

  As for $d(\yon)=4^\yon+3$, recall that its area is $A(d)=7$ and its width is $2\sqrt[7]{2}$.
  Now, its entropy is
  \[
    \begin{aligned}
      H(d)
      &= -\sum_{i\in\underline{4}}\frac{|d[i]|}{7}\log\left(\frac{|d[i]|}{7}\right)
    \\&= -\frac{4}{7}\log\left(\frac{4}{7}\right) - 3\cdot\frac{1}{7}\log\left(\frac{1}{7}\right)
    \\&= \frac{\log7}{\log2} - \frac{8}{7}
    \end{aligned}
  \]
  and so its length is
  \[
    L(d) = 2^{\frac{\log7}{\log2} - \frac{8}{7}} = \frac{7}{2\sqrt[7]{2}}
  \]
  which (maybe surprisingly) is still such that $A(d)=L(d)W(d)$, even though we have non-integer values for both $L(d)$ and $W(d)$.
\end{example}

We now come to our main theorem.
It says that the Shannon entropy, which is only homomorphic in products of distributions, can be computed in terms of the width and area, which together are homomorphic in both sums and products of distributions.
We will explain this in more detail in \cref{section:understanding-the-numbers}.

\begin{theorem}
\label{theorem:rectangle-area-formula}
  For all $d\in\Dir$, we have the \emph{rectangle-area formula}
  \[
    A(d) = L(d)W(d).
  \]
\end{theorem}

\begin{proof}
  Write
  \[
    d(\yon) \coloneqq \sum_{j=0}^n a_j j^\yon \cong \sum_{i\in d(0)}d[i]^\yon.
  \]
  We can rewrite the length as
  \[
    \begin{aligned}
      L(d)
      &= 2^{H(d)}
    \\&= 2^{-\sum_{i\in d(0)}\frac{|d[i]|}{|d(1)|}\log\left(\frac{|d[i]|}{|d(1)|}\right)}
    \\&= \prod_{i\in d(0)} 2^{-\frac{|d[i]|}{|d(1)|}\log\left(\frac{|d[i]|}{|d(1)|}\right)}
    \\&= \prod_{i\in d(0)} \left(2^{-\log\left(\frac{|d[i]|}{|d(1)|}\right)}\right)^{\frac{|d[i]|}{|d(1)|}}
    \\&= \prod_{i\in d(0)} \frac{|d(1)|}{|d[i]|}^{\frac{|d[i]|}{|d(1)|}}
    \\&= \frac{\prod_{i\in d(0)} |d(1)|^{\frac{|d[i]|}{|d(1)|}}}{\prod_{i\in d(0)} |d[i]|^{\frac{|d[i]|}{|d(1)|}}}
    \end{aligned}
  \]
  The numerator is then
  \[
    \begin{aligned}
      \prod\nolimits_{i\in d(0)} |d(1)|^{\frac{|d[i]|}{|d(1)|}}
      &= |d(1)|^{\sum_{i\in d(0)}\frac{|d[i]|}{|d(1)|}}
    \\&= |d(1)|
    \\&= A(d)
    \end{aligned}
  \]
  since $\sum_{i\in d(0)}|d[i]|=|d(1)|$, by \cref{corollary:d0-and-d1-from-fibre-form}, and we can then apply \cref{corollary:area-and-width}.
  The denominator is exactly
  \[
    \left(\prod\nolimits_{i\in d(0)} |d[i]|^{|d[i]|}\right)^{\frac{1}{|d(1)|}}
  \]
  and so, by \cref{corollary:area-and-width}, we only need to justify why $\prod_{i\in d(0)}|d[i]|^{|d[i]|}$ is equal to $|\cDir_{/d(0)}(d,d)|$.
  But this follows from the definition of an element of the latter set: a choice of map $d[i]\to d[i]$ for all $i\in d(0)$.
\end{proof}


\section{Interpreting area, length, and width}
\label{section:understanding-the-numbers}

\begin{remark}
\label{remark:why-dir-instead-of-bun}
  We have mentioned many times that Dirichlet polynomials are equivalent to set-theoretic bundles, so the natural question to ask is ``\emph{why, then, should we work with the former instead of the latter?}''.
  One answer to this is question is the fact that \emph{entropy does not respect bundle morphisms}\footnote{That is, we cannot functorially assign a morphism between entropies to morphisms, since we are working with \textbf{arbitrary} morphisms of bundles. If, however, we restrict to only morphisms given by pushforward, then \cite{BFL2011} tells us (via \emph{Faddeev's theorem}) that the only possible functorial definition of entropy is given by the \emph{relative entropy}, i.e. the difference of the entropies of the source and the target.}, and so it seems rather bad to work with a \emph{category} (such as that of bundles) instead of simply a \emph{rig} (such as that of Dirichlet polynomials).
  Of course, this isn't an entirely satisfactory answer, since we \emph{do} care about the notion of morphisms for Dirichlet polynomials (for example, \cref{corollary:area-and-width} tells us that the width can be expressed in terms of the number of certain morphisms).
  In light of \cref{theorem:rectangle-area-formula}, however, we might consider the following possibility:
  both area and length can be expressed in terms of $d(0)$, $d(1)$, and $d[i]$ (for $i\in d(0)$), and we could \emph{define} the width by $W(d)\coloneqq A(d)/L(d)$.

  A better answer to this question might be the following:
  the rig homomorphism $h\colon\Dir\to\Rect$ is incredibly simple, since it just maps $n^\yon$ to $(n,n)$;
  from this computationally simple homomorphism, however, we can recover entropy (as $\log(A(d)/W(d))$), without making any reference to the classical equation that defines it (``negative the sum of probabilities of the log of the probabilities''), but instead relying on the fact that $\Rect$ encodes the weighted geometric mean.

  That is, $H(d)$ is only homomorphic in the product of distributions, whereas $(A(d),W(d))$ is homomorphic in both the product and the sum.
\end{remark}

\begin{remark}
  The entropy $H(d)=\log L(d)$ can be understood (via Huffman coding, cf. \cite{H1952}) as \emph{the average number of bits needed to code a single outcome} (over a long enough message).
  What is also true, however, is that the width (which is obtained purely ``algebraically'', i.e. from the rig homomorphism $h\colon\Dir\to\Rect$) gives similar information: by \cref{theorem:rectangle-area-formula}, combined with the previous sentence, $\log W(d)$ is \emph{the average number of bits needed to code the draw, given an outcome} (in the same Huffman coding as before).
  This answers the question of ``\emph{what is special about the bundle defined by the width and length}'' with ``\emph{it describes the optimal encoding of draws, given outcomes}''.

  As for the picture in \cref{example:width-and-equal-distribution}, we can now understand the hand-wavy explanation a bit better (but still just as hand-wavy-ly):
  we take our original ``half-filled'' rectangle $d(1)$ and pour its contents into a new rectangle, of length $L(d)$, and then ``slosh the contents around'' until they lie flat, and then put a lid on it;
  the rectangle will be perfectly filled up, and the placement of the lid will be given by $W(d)$.
\end{remark}

\begin{remark}
  We mentioned, in \cref{corollary:width-is-algebraic}, that the width $W(d)$ of any Dirichlet polynomial $d$ is an algebraic number, but the actual result is slightly more interesting that this:
  \cref{corollary:area-and-width} tells us that $W(d)^{A(d)}$ is equal to the cardinality of the set $\cDir_{/d(0)}(d,d)$.
  We already know how to understand endomorphisms of $d$ that fix $d(0)$ as endomorphisms of $d(1)$ that fix the outcome;
  we can understand $W(d)^{A(d)}$ as maps from $A(d)$ to $W(d)$;
  roughly speaking, such a map $f\colon A(d)\to W(d)$ determines the remaining ambiguity in determining a draw, given its outcome.
\end{remark}



\section{Cross entropy}
\label{section:cross-entropy}

Everything above can be viewed as a specific example of the analogous \emph{cross} notions.
That is, given two Dirichlet polynomials, we can define their cross area, cross width, etc. as follows.

\begin{definition}
\label{definition:cross-notions}
  Let $d,e\in\Dir$ be Dirichlet polynomials such that $d(0)=e(0)$.
  Then we define the \emph{cross entropy} $H(d,e)$ by
  \[
    H(d,e) = -\sum_{i\in d(0)}\frac{|d[i]|}{|d(1)|}\log\left(\frac{|e[i]|}{|e(1)|}\right)
  \]
  and the \emph{cross area}, \emph{cross width}, and \emph{cross length} by
  \[
    \begin{aligned}
      A(d,e) &\coloneqq |e(1)|
    \\W(d,e) &\coloneqq \left\vert\cDir_{/d(0)}(d,e)\right\vert^{\frac{1}{|d(1)|}}
    \\L(d,e) &\coloneqq 2^{H(d,e)}
    \end{aligned}
  \]
  (respectively).
\end{definition}

By definition, $X(d,d)=X(d)$ for $X\in\{A,W,H,L\}$.
That is, just as cross entropy is a generalisation of entropy, the notions of cross width etc. generalise the notions of width etc.

\begin{remark}
  Note that we can recover the notion of \emph{relative entropy} (also known as \emph{Kullback--Leibler divergence}) $D_{\mathrm{KL}}(p\|q)$, as studied in \cite{BF2014}, from cross entropy:
  \[
    H(d,e) = H(d) + D_{\mathrm{KL}}(p\|q)
  \]
  (which can also be seen to justify the fact that $H(d,d)=H(d)$).
\end{remark}

\begin{remark}
  Although we have some idea of how to understand these cross notions (e.g., cross area can be understood as the number of ``actual'' draws, when we think of $d$ as being a potentially inaccurate model for $e$), the choice of definitions in \cref{definition:cross-notions} was chosen simply so that
  \begin{enumerate}
    \item we recover the ``uncrossed'' notions when we take $d=e$, and
    \item \cref{theorem:cross-rectangle-area-formula} holds.\qedhere
  \end{enumerate}
\end{remark}

\begin{theorem}
\label{theorem:cross-rectangle-area-formula}
  For all $d,e\in\Dir$, we have the \emph{cross rectangle-area formula}
  \[
    A(d,e) = L(d,e)W(d,e).
  \]
\end{theorem}

\begin{proof}
  This proof follows exactly the same argument as the proof of \cref{theorem:rectangle-area-formula}.
\end{proof}


% Bibliography

\printbibliography[heading=bibintoc,title=Bibliography]

\end{document}
